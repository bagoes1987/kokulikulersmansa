<!DOCTYPE html>
<html class="light" lang="id">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Dashboard Kegiatan - SMAN 1 Belitang</title>
    <link rel="icon" href="./logo-sekolah.png" type="image/png">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "emerald-custom": "#10B981",
                        "terracotta": "#E2725B",
                        "bg-main": "#F8FAFB",
                    },
                    fontFamily: {
                        "sans": ["Inter", "sans-serif"]
                    }
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        @layer base {
            body {
                @apply font-sans bg-bg-main text-slate-800;
            }
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 48;
        }

        .ios-shadow {
            box-shadow: 0 4px 20px -1px rgba(0, 0, 0, 0.05);
        }

        .circular-progress {
            background: conic-gradient(#10B981 0deg, #E2E8F0 0deg);
            transition: background 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
        .animate-slide-up { animation: slideUp 0.4s ease-out; }
    </style>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>

<body class="min-h-screen">
    <div class="relative flex min-h-screen w-full flex-col max-w-md mx-auto bg-bg-main overflow-x-hidden pb-24">
        <!-- Header -->
        <header
            class="sticky top-0 z-50 bg-white/80 backdrop-blur-lg border-b border-slate-100 px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="h-16 w-16 rounded-full bg-cover bg-center border-2 border-slate-100 shadow-sm"
                    id="studentPhoto"
                    style='background-image: url("https://ui-avatars.com/api/?name=Siswa&background=13ec6d&color=fff&size=256");'>
                </div>
                <div>
                    <h1 class="text-lg font-black text-slate-900 leading-tight" id="headerStudentName">Memuat...</h1>
                    <p class="text-[13px] text-slate-500 font-bold mt-0.5">
                        <span id="headerClass">...</span> • SMAN 1 BELITANG
                    </p>
                    <div class="mt-2.5 flex flex-col gap-1">
                        <p class="text-[11px] text-slate-400 font-medium leading-none">Koord: <span id="headerCoord"
                                class="text-slate-700 font-bold">-</span></p>
                        <p class="text-[11px] text-slate-400 font-medium leading-none">Fasil: <span id="headerFasil"
                                class="text-slate-700 font-bold">-</span></p>
                    </div>
                </div>
            </div>
            <div class="relative flex items-center justify-center">
                <div class="circular-progress h-14 w-14 rounded-full flex items-center justify-center"
                    id="progressCircle">
                    <div class="h-11 w-11 bg-white rounded-full flex items-center justify-center">
                        <span class="text-[12px] font-bold text-emerald-custom" id="progressPercent">0%</span>
                    </div>
                </div>
                <!-- Checkmark muncul jika 100% -->
                <div class="absolute -bottom-2 -right-1 bg-white rounded-full p-0.5 shadow-sm hidden"
                    id="progressCheck">
                    <span class="material-symbols-outlined !text-xs text-emerald-custom">check_circle</span>
                </div>
            </div>
        </header>

        <!-- Day Tabs -->
        <div class="px-6 py-6">
            <div class="bg-slate-200/50 p-1 rounded-2xl flex items-center">
                <button onclick="switchDay(1)"
                    class="flex-1 py-3 rounded-xl text-base font-semibold bg-white text-emerald-custom shadow-sm transition-all"
                    id="tab-day1">Hari 1</button>
                <button onclick="switchDay(2)"
                    class="flex-1 py-3 rounded-xl text-base font-semibold text-slate-500 hover:text-slate-700 transition-all"
                    id="tab-day2">Hari 2</button>
                <button onclick="switchDay(3)"
                    class="flex-1 py-3 rounded-xl text-base font-semibold text-slate-500 hover:text-slate-700 transition-all"
                    id="tab-day3">Hari 3</button>
            </div>
        </div>

        <!-- Title -->
        <div class="px-6 mb-4">
            <h2 class="text-2xl font-bold text-slate-900">Dasbor Kegiatan</h2>
            <p class="text-base text-slate-500">Selesaikan modul hari ini</p>
        </div>

        <!-- Module Grid -->
        <div class="grid grid-cols-2 gap-4 px-6">
            <!-- Pertanyaan Pemantik -->
            <div onclick="toggleModule('pemantik')"
                class="bg-amber-50/50 p-4 rounded-[24px] ios-shadow border border-amber-100/50 flex flex-col gap-4 cursor-pointer hover:scale-105 transition-transform active:scale-95">
                <div
                    class="h-12 w-12 rounded-2xl bg-amber-400 flex items-center justify-center text-white shadow-lg shadow-amber-200">
                    <span class="material-symbols-outlined !text-2xl">lightbulb</span>
                </div>
                <div>
                    <h3 class="text-[15px] font-bold text-slate-800">Pertanyaan Pemantik</h3>
                    <div class="flex items-center gap-1 mt-1">
                        <span class="material-symbols-outlined !text-base text-slate-400"
                            id="status-pemantik">radio_button_unchecked</span>
                        <span class="text-[13px] font-semibold text-slate-400" id="label-pemantik">Belum
                            Selesai</span>
                    </div>
                </div>
            </div>

            <!-- Materi Belajar -->
            <div onclick="toggleModule('materi')"
                class="bg-blue-50/50 p-4 rounded-[24px] ios-shadow border border-blue-100/50 flex flex-col gap-4 cursor-pointer hover:scale-105 transition-transform active:scale-95">
                <div
                    class="h-12 w-12 rounded-2xl bg-blue-500 flex items-center justify-center text-white shadow-lg shadow-blue-200">
                    <span class="material-symbols-outlined !text-2xl">description</span>
                </div>
                <div>
                    <h3 class="text-[15px] font-bold text-slate-800">Materi Belajar</h3>
                    <div class="flex items-center gap-1 mt-1">
                        <span class="material-symbols-outlined !text-base text-slate-400"
                            id="status-materi">radio_button_unchecked</span>
                        <span class="text-[13px] font-semibold text-slate-400" id="label-materi">Belum
                            Selesai</span>
                    </div>
                </div>
            </div>

            <!-- Video Belajar -->
            <div onclick="toggleModule('video')"
                class="bg-red-50/50 p-4 rounded-[24px] ios-shadow border border-red-100/50 flex flex-col gap-4 cursor-pointer hover:scale-105 transition-transform active:scale-95">
                <div
                    class="h-12 w-12 rounded-2xl bg-red-500 flex items-center justify-center text-white shadow-lg shadow-red-200">
                    <span class="material-symbols-outlined !text-2xl">play_circle</span>
                </div>
                <div>
                    <h3 class="text-[15px] font-bold text-slate-800">Video Belajar</h3>
                    <div class="flex items-center gap-1 mt-1">
                        <span class="material-symbols-outlined !text-base text-slate-400"
                            id="status-video">radio_button_unchecked</span>
                        <span class="text-[13px] font-semibold text-slate-400" id="label-video">Belum
                            Selesai</span>
                    </div>
                </div>
            </div>

            <!-- LKPD Digital -->
            <div onclick="toggleModule('lkpd')"
                class="bg-orange-50/50 p-4 rounded-[24px] ios-shadow border border-orange-100/50 flex flex-col gap-4 cursor-pointer hover:scale-105 transition-transform active:scale-95">
                <div
                    class="h-12 w-12 rounded-2xl bg-terracotta flex items-center justify-center text-white shadow-lg shadow-terracotta/30">
                    <span class="material-symbols-outlined !text-2xl">edit_note</span>
                </div>
                <div>
                    <h3 class="text-[15px] font-bold text-slate-800">LKPD Digital</h3>
                    <div class="flex items-center gap-1 mt-1">
                        <span class="material-symbols-outlined !text-base text-slate-400"
                            id="status-lkpd">radio_button_unchecked</span>
                        <span class="text-[13px] font-semibold text-slate-400" id="label-lkpd">Belum
                            Selesai</span>
                    </div>
                </div>
            </div>

            <!-- Asesmen -->
            <div onclick="toggleModule('asesmen')"
                class="bg-purple-50/50 p-4 rounded-[24px] ios-shadow border border-purple-100/50 flex flex-col gap-4 cursor-pointer hover:scale-105 transition-transform active:scale-95">
                <div
                    class="h-12 w-12 rounded-2xl bg-purple-500 flex items-center justify-center text-white shadow-lg shadow-purple-200">
                    <span class="material-symbols-outlined !text-2xl">task_alt</span>
                </div>
                <div>
                    <h3 class="text-[15px] font-bold text-slate-800">Asesmen</h3>
                    <div class="flex items-center gap-1 mt-1">
                        <span class="material-symbols-outlined !text-base text-slate-400"
                            id="status-asesmen">radio_button_unchecked</span>
                        <span class="text-[13px] font-semibold text-slate-400" id="label-asesmen">Belum
                            Selesai</span>
                    </div>
                </div>
            </div>

            <!-- Rangkuman -->
            <div onclick="toggleModule('rangkuman')"
                class="bg-indigo-50/50 p-4 rounded-[24px] ios-shadow border border-indigo-100/50 flex flex-col gap-4 cursor-pointer hover:scale-105 transition-transform active:scale-95">
                <div
                    class="h-12 w-12 rounded-2xl bg-indigo-500 flex items-center justify-center text-white shadow-lg shadow-indigo-200">
                    <span class="material-symbols-outlined !text-2xl">auto_stories</span>
                </div>
                <div>
                    <h3 class="text-[15px] font-bold text-slate-800">Rangkuman</h3>
                    <div class="flex items-center gap-1 mt-1">
                        <span class="material-symbols-outlined !text-base text-slate-400"
                            id="status-rangkuman">radio_button_unchecked</span>
                        <span class="text-[13px] font-semibold text-slate-400" id="label-rangkuman">Belum
                            Selesai</span>
                    </div>
                </div>
            </div>

            <!-- Glosarium -->
            <div onclick="toggleModule('glosarium')"
                class="bg-cyan-50/50 p-4 rounded-[24px] ios-shadow border border-cyan-100/50 flex flex-col gap-4 cursor-pointer hover:scale-105 transition-transform active:scale-95">
                <div
                    class="h-12 w-12 rounded-2xl bg-cyan-500 flex items-center justify-center text-white shadow-lg shadow-cyan-200">
                    <span class="material-symbols-outlined !text-2xl">dictionary</span>
                </div>
                <div>
                    <h3 class="text-[15px] font-bold text-slate-800">Glosarium</h3>
                    <div class="flex items-center gap-1 mt-1">
                        <span class="material-symbols-outlined !text-base text-slate-400"
                            id="status-glosarium">radio_button_unchecked</span>
                        <span class="text-[13px] font-semibold text-slate-400" id="label-glosarium">Belum
                            Selesai</span>
                    </div>
                </div>
            </div>

            <!-- Refleksi -->
            <div onclick="toggleModule('refleksi')"
                class="bg-emerald-50/50 p-4 rounded-[24px] ios-shadow border border-emerald-100/50 flex flex-col gap-4 cursor-pointer hover:scale-105 transition-transform active:scale-95">
                <div
                    class="h-12 w-12 rounded-2xl bg-emerald-custom flex items-center justify-center text-white shadow-lg shadow-emerald-200">
                    <span class="material-symbols-outlined !text-2xl">psychology_alt</span>
                </div>
                <div>
                    <h3 class="text-[15px] font-bold text-slate-800">Refleksi</h3>
                    <div class="flex items-center gap-1 mt-1">
                        <span class="material-symbols-outlined !text-base text-slate-400"
                            id="status-refleksi">radio_button_unchecked</span>
                        <span class="text-[13px] font-semibold text-slate-400" id="label-refleksi">Belum
                            Selesai</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav
            class="fixed bottom-0 w-full max-w-md bg-white/90 backdrop-blur-xl border-t border-slate-100 px-8 py-3 pb-8 flex justify-between items-center z-[100]">
            <button onclick="window.location.href='index.html'"
                class="flex flex-col items-center gap-1 text-slate-400 transition-transform active:scale-90">
                <span class="material-symbols-outlined !text-2xl">home</span>
                <span class="text-[12px] font-medium">Beranda</span>
            </button>
            <button onclick="window.location.href='dashboard-kegiatan.html'"
                class="flex flex-col items-center gap-1 text-emerald-custom transition-transform active:scale-90">
                <span class="material-symbols-outlined !text-2xl">grid_view</span>
                <span class="text-[12px] font-bold">Dasbor</span>
            </button>
            <button onclick="window.location.href='pengaturan-akun.html'"
                class="flex flex-col items-center gap-1 text-slate-400 transition-transform active:scale-90">
                <span class="material-symbols-outlined !text-2xl">person</span>
                <span class="text-[12px] font-medium">Profil</span>
            </button>
            <button onclick="logout()"
                class="flex flex-col items-center gap-1 text-slate-400 transition-transform active:scale-90 hover:text-red-500">
                <span class="material-symbols-outlined !text-2xl">logout</span>
                <span class="text-[12px] font-medium">Keluar</span>
            </button>
        </nav>
    </div>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        // Inisialisasi Supabase
        const supabaseUrl = 'https://jnsqqswpkigyzewnbvaf.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impuc3Fxc3dwa2lneXpld25idmFmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2NjA3NDIsImV4cCI6MjA4NTIzNjc0Mn0.RrjPnddC55Xv9CLCtG8-1RyDmEkYg_04tHeKqRE7pok';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        let currentDay = 1;

        // Struktur data progress default (3 hari x 8 modul)
        const defaultProgress = {
            day1: { pemantik: false, materi: false, video: false, lkpd: false, asesmen: false, rangkuman: false, glosarium: false, refleksi: false },
            day2: { pemantik: false, materi: false, video: false, lkpd: false, asesmen: false, rangkuman: false, glosarium: false, refleksi: false },
            day3: { pemantik: false, materi: false, video: false, lkpd: false, asesmen: false, rangkuman: false, glosarium: false, refleksi: false }
        };

        let studentProgress = JSON.parse(JSON.stringify(defaultProgress));

        // Load student data
        async function loadStudentData() {
            try {
                const { data: { session } } = await supabaseClient.auth.getSession();

                if (!session) {
                    window.location.href = 'login-siswa.html';
                    return;
                }

                const studentDataStr = localStorage.getItem('student_data');

                if (studentDataStr) {
                    const studentData = JSON.parse(studentDataStr);

                    // Update Header Info (Nama & Kelas)
                    document.getElementById('headerStudentName').textContent = studentData.nama || 'Siswa';
                    document.getElementById('headerClass').textContent = studentData.kelas || 'X.1';

                    // Update header photo
                    if (studentData.photo_url) {
                        document.getElementById('studentPhoto').style.backgroundImage = `url("${studentData.photo_url}")`;
                    } else {
                        const photoUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(studentData.nama)}&background=13ec6d&color=fff&size=256`;
                        document.getElementById('studentPhoto').style.backgroundImage = `url("${photoUrl}")`;
                    }

                    // --- MAPPING KOORDINATOR & FASILITATOR ---
                    const trialMap = {
                        'X.TRIAL-1': { koord: 'Koordinator Trial A', fasil: 'Fasilitator Trial 1' },
                        'X.TRIAL-2': { koord: 'Koordinator Trial A', fasil: 'Fasilitator Trial 2' },
                        'X.TRIAL-3': { koord: 'Koordinator Trial B', fasil: 'Fasilitator Trial 3' }
                    };

                    const userClass = studentData.kelas;

                    if (trialMap[userClass]) {
                        // Jika kelas trial
                        document.getElementById('headerCoord').textContent = trialMap[userClass].koord;
                        document.getElementById('headerFasil').textContent = trialMap[userClass].fasil;
                    } else {
                        // Jika kelas real (Logic Sementara / Placeholder)
                        // TODO: Implementasi fetch real jika tabel relasi sudah siap
                        document.getElementById('headerCoord').textContent = 'Bu Lucia Erviana';
                        document.getElementById('headerFasil').textContent = 'Fasilitator Kelas ' + (userClass || '-');
                    }
                }

                // Load progress dari localStorage
                loadProgress();
                updateDashboardUI();

            } catch (error) {
                console.error('Error loading student data:', error);
                window.location.href = 'login-siswa.html';
            }
        }

        // Load progress logic
        function loadProgress() {
            const savedProgress = localStorage.getItem('student_progress');
            if (savedProgress) {
                studentProgress = JSON.parse(savedProgress);
            } else {
                studentProgress = JSON.parse(JSON.stringify(defaultProgress));
            }
            calculateGlobalProgress();
        }

        function saveProgress() {
            localStorage.setItem('student_progress', JSON.stringify(studentProgress));
            calculateGlobalProgress();
        }

        // Toggle module completion
        function toggleModule(moduleId) {
            // Override untuk Hari 1
            if (currentDay === 1) {
                if (moduleId === 'mantik' || moduleId === 'pemantik') {
                    openPemantikModal();
                    return;
                }
                if (moduleId === 'materi') {
                    openMateriModal();
                    return;
                }
            }

            const dayKey = `day${currentDay}`;
            // Toggle status
            studentProgress[dayKey][moduleId] = !studentProgress[dayKey][moduleId];
            saveProgress();
            updateModuleUI(moduleId, studentProgress[dayKey][moduleId]);
        }

        // Helper untuk memanggil toggle original dari dalam modal
        function forceCompleteModule(moduleId) {
            const dayKey = `day${currentDay}`;
            studentProgress[dayKey][moduleId] = true;
            saveProgress();
            updateModuleUI(moduleId, true);
        }

        // Update UI for a single module
        function updateModuleUI(moduleId, isComplete) {
            const statusIcon = document.getElementById(`status-${moduleId}`);
            const statusLabel = document.getElementById(`label-${moduleId}`);

            if (isComplete) {
                statusIcon.textContent = 'check_circle';
                statusIcon.classList.remove('text-slate-400');
                statusIcon.classList.add('text-emerald-custom');

                statusLabel.textContent = 'Selesai';
                statusLabel.classList.remove('text-slate-400');
                statusLabel.classList.add('text-emerald-custom');
            } else {
                statusIcon.textContent = 'radio_button_unchecked';
                statusIcon.classList.remove('text-emerald-custom');
                statusIcon.classList.add('text-slate-400');

                statusLabel.textContent = 'Belum Selesai';
                statusLabel.classList.remove('text-emerald-custom');
                statusLabel.classList.add('text-slate-400');
            }
        }

        // Update all modules UI based on current day
        function updateDashboardUI() {
            const dayKey = `day${currentDay}`;
            const currentDayProgress = studentProgress[dayKey];

            Object.keys(currentDayProgress).forEach(moduleId => {
                updateModuleUI(moduleId, currentDayProgress[moduleId]);
            });
        }

        // Calculate and update global progress circle
        function calculateGlobalProgress() {
            let totalItems = 0;
            let completedItems = 0;

            // Hitung semua item dari 3 hari
            Object.values(studentProgress).forEach(day => {
                Object.values(day).forEach(status => {
                    totalItems++;
                    if (status) completedItems++;
                });
            });

            const percent = Math.round((completedItems / totalItems) * 100);

            // Update Text
            document.getElementById('progressPercent').textContent = `${percent}%`;

            // Update Circle Gradient
            const degree = Math.round((percent / 100) * 360);
            document.getElementById('progressCircle').style.background = `conic-gradient(#10B981 ${degree}deg, #E2E8F0 0deg)`;

            // Show checkmark if 100%
            const checkmark = document.getElementById('progressCheck');
            if (percent === 100) {
                checkmark.classList.remove('hidden');
            } else {
                checkmark.classList.add('hidden');
            }
        }

        // Switch day tabs
        function switchDay(day) {
            currentDay = day;

            // Update tab styles
            for (let i = 1; i <= 3; i++) {
                const tab = document.getElementById(`tab-day${i}`);
                if (i === day) {
                    tab.className = 'flex-1 py-2.5 rounded-xl text-sm font-semibold bg-white text-emerald-custom shadow-sm transition-all';
                } else {
                    tab.className = 'flex-1 py-2.5 rounded-xl text-sm font-semibold text-slate-500 hover:text-slate-700 transition-all';
                }
            }

            // Update modules display based on new day
            updateDashboardUI();
        }

        // Logout function
        async function logout() {
            try {
                const { error } = await supabaseClient.auth.signOut();
                if (error) throw error;
                // Redirect to index.html (Beranda)
                window.location.href = 'index.html';
            } catch (error) {
                console.error('Error logging out:', error.message);
                alert('Gagal keluar. Silakan coba lagi.');
            }
        }

        // Load data on page load
        window.addEventListener('load', loadStudentData);

        // ==========================================
        // FITUR PERTANYAAN PEMANTIK
        // ==========================================

        // Buka Modal Pemantik
        function openPemantikModal() {
            const modal = document.getElementById('modalPemantik');
            modal.classList.remove('hidden');
            modal.classList.add('flex');

            // Cek apakah sudah ada jawaban
            checkExistingPemantik();
        }

        // Tutup Modal
        function closePemantikModal() {
            const modal = document.getElementById('modalPemantik');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }


        // ==========================================
        // FITUR MATERI BELAJAR (SLIDE)
        // ==========================================

        let currentMateriSlide = 0;
        const totalMateriSlides = 8;

        function openMateriModal() {
            currentMateriSlide = 0;
            document.getElementById('modalMateri').classList.remove('hidden');
            document.getElementById('modalMateri').classList.add('flex');
            updateMateriSlideUI();
        }

        function closeMateriModal() {
            document.getElementById('modalMateri').classList.add('hidden');
            document.getElementById('modalMateri').classList.remove('flex');
        }

        function nextMateriSlide() {
            if (currentMateriSlide < totalMateriSlides - 1) {
                currentMateriSlide++;
                updateMateriSlideUI();
                // Scroll content ke atas setiap ganti slide
                document.getElementById('materiContentArea').scrollTop = 0;
            }
        }

        function prevMateriSlide() {
            if (currentMateriSlide > 0) {
                currentMateriSlide--;
                updateMateriSlideUI();
                document.getElementById('materiContentArea').scrollTop = 0;
            }
        }

        function updateMateriSlideUI() {
            // Hide semua slide
            for (let i = 0; i < totalMateriSlides; i++) {
                const s = document.getElementById(`slide-materi-${i}`);
                if (s) s.classList.add('hidden');
            }
            // Tampilkan slide aktif
            document.getElementById(`slide-materi-${currentMateriSlide}`).classList.remove('hidden');

            // Update Progress Bar
            const progress = ((currentMateriSlide + 1) / totalMateriSlides) * 100;
            document.getElementById('materiProgressBar').style.width = `${progress}%`;
            document.getElementById('materiStepText').textContent = `Halaman ${currentMateriSlide + 1} dari ${totalMateriSlides}`;

            // Update Tombol
            const btnPrev = document.getElementById('btnPrevMateri');
            const btnNext = document.getElementById('btnNextMateri');
            const btnFinish = document.getElementById('btnFinishMateri');

            // Tombol Kembali
            if (currentMateriSlide === 0) {
                btnPrev.classList.add('invisible');
            } else {
                btnPrev.classList.remove('invisible');
            }

            // Tombol Lanjut vs Selesai
            if (currentMateriSlide === totalMateriSlides - 1) {
                btnNext.classList.add('hidden');
                btnFinish.classList.remove('hidden');
            } else {
                btnNext.classList.remove('hidden');
                btnFinish.classList.add('hidden');
            }
        }

        function settleMateri() {
            // Mark as complete
            forceCompleteModule('materi');
            alert('Selamat! Kamu telah menyelesaikan materi hari ini.');
            closeMateriModal();
        }

        // Kirim Jawaban
        async function submitPemantik() {
            const btn = document.getElementById('btnSubmitPemantik');
            btn.innerHTML = 'Mengirim...';
            btn.disabled = true;

            // Ambil jawaban dari 5 textarea
            const answers = [];
            for (let i = 1; i <= 5; i++) {
                const val = document.getElementById(`tanya${i}`).value;
                if (!val) {
                    alert(`Jawaban nomor ${i} belum diisi!`);
                    btn.innerHTML = 'Kirim Jawaban';
                    btn.disabled = false;
                    return;
                }
                answers.push(val);
            }

            try {
                const { data: { user } } = await supabaseClient.auth.getUser();
                if (!user) throw new Error("User tidak ditemukan");

                // Simpan ke Supabase
                const { error } = await supabaseClient
                    .from('module_responses')
                    .insert({
                        student_id: user.id,
                        day_id: 1,
                        module_type: 'pemantik',
                        answers: answers,
                        status: 'submitted' // Status awal
                    });

                if (error) throw error;

                // Berhasil
                alert('Jawaban berhasil dikirim! Menunggu feedback dari fasilitator.');

                // Update UI Lokal (Tanpa centang hijau, tapi kuning)
                updatePemantikStatusUI('submitted');
                closePemantikModal();

            } catch (err) {
                console.error('Gagal kirim:', err);
                alert('Terjadi kesalahan saat mengirim jawaban.');
            } finally {
                btn.innerHTML = 'Kirim Jawaban';
                btn.disabled = false;
            }
        }

        // Cek Status Jawaban (Saat load / buka modal)
        async function checkExistingPemantik() {
            try {
                const { data: { user } } = await supabaseClient.auth.getUser();
                if (!user) return;

                const { data, error } = await supabaseClient
                    .from('module_responses')
                    .select('*')
                    .eq('student_id', user.id)
                    .eq('day_id', 1)
                    .eq('module_type', 'pemantik')
                    .single();

                if (data) {
                    // Isi form dengan jawaban lama
                    data.answers.forEach((ans, idx) => {
                        const el = document.getElementById(`tanya${idx + 1}`);
                        if (el) {
                            el.value = ans;
                            el.disabled = true; // Disable edit jika sudah submit
                        }
                    });

                    // Hide tombol kirim jika sudah submit
                    document.getElementById('btnSubmitPemantik').classList.add('hidden');

                    // Show status message
                    const statusMsg = document.getElementById('statusMessage');
                    statusMsg.classList.remove('hidden');

                    if (data.status === 'submitted') {
                        statusMsg.className = "bg-yellow-50 text-yellow-700 p-4 rounded-xl border border-yellow-200 text-xs font-medium mb-4";
                        statusMsg.innerHTML = "⏳ <b>Jawaban Terkirim</b><br>Menunggu feedback dari fasilitator.";
                        updatePemantikStatusUI('submitted');
                    } else if (data.status === 'reviewed') {
                        statusMsg.className = "bg-emerald-50 text-emerald-700 p-4 rounded-xl border border-emerald-200 text-xs font-medium mb-4";
                        statusMsg.innerHTML = `✅ <b>Sudah Direview</b><br>Feedback: "${data.feedback || '-'}"`;

                        // Jika sudah direview, barulah centang hijau (update progress)
                        // Cek apakah progress lokal sudah true? Jika belum, update.
                        if (!studentProgress.day1.pemantik) {
                            originalToggleModule('pemantik'); // Paksa centang hijau
                        }
                    }

                } else {
                    // Belum ada data
                    document.getElementById('statusMessage').classList.add('hidden');
                    document.getElementById('btnSubmitPemantik').classList.remove('hidden');
                    // Enable inputs
                    for (let i = 1; i <= 5; i++) {
                        document.getElementById(`tanya${i}`).disabled = false;
                    }
                }

            } catch (err) {
                // No data found is okay (PGRST116)
                // console.log("Belum ada jawaban");
            }
        }

        // Helper: Update Tampilan Icon di Dashboard (Kuning jika pending)
        function updatePemantikStatusUI(status) {
            const statusIcon = document.getElementById('status-pemantik');
            const statusLabel = document.getElementById('label-pemantik');

            if (status === 'submitted') {
                statusIcon.textContent = 'hourglass_top'; // Icon jam pasir
                statusIcon.className = 'material-symbols-outlined !text-[14px] text-yellow-500';
                statusLabel.textContent = 'Menunggu Feedback';
                statusLabel.className = 'text-[11px] font-semibold text-yellow-500';
            }
        }

        // Panggil cek status saat load juga, biar tampilan dashboard update
        // (Opsional, agar pas refresh langsung kuning iconnya)
        checkExistingPemantik();

    </script>

    <!-- MODAL PERTANYAAN PEMANTIK -->
    <div id="modalPemantik"
        class="fixed inset-0 z-[200] hidden items-center justify-center bg-slate-900/40 backdrop-blur-sm p-4 animate-fade-in">
        <div class="bg-white w-full max-w-lg rounded-[2rem] shadow-2xl max-h-[90vh] flex flex-col overflow-hidden">
            <!-- Header -->
            <div class="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                <div>
                    <h3 class="text-lg font-black text-slate-800">Pertanyaan Pemantik</h3>
                    <p class="text-xs text-slate-500 font-medium">Hari 1 • Jajanan Nusantara</p>
                </div>
                <button onclick="closePemantikModal()"
                    class="size-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 hover:bg-slate-200 transition-colors">
                    <span class="material-symbols-outlined text-xl">close</span>
                </button>
            </div>

            <!-- Scrollable Content -->
            <div class="p-6 overflow-y-auto no-scrollbar space-y-6">

                <!-- Status Message Area -->
                <div id="statusMessage" class="hidden"></div>

                <!-- Soal 1 -->
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-700 block leading-relaxed">
                        1. Kapan terakhir kali kamu menikmati jajanan khas Nusantara, dan apa yang membuatmu lebih
                        memilih jajanan tersebut dibandingkan makanan modern atau camilan instan saat itu?
                    </label>
                    <textarea id="tanya1" rows="3"
                        class="w-full text-xs p-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-emerald-500 bg-slate-50 focus:bg-white transition-all placeholder:text-slate-300"
                        placeholder="Tulis jawabanmu disini..."></textarea>
                </div>

                <!-- Soal 2 -->
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-700 block leading-relaxed">
                        2. Apa nama jajanan tersebut? Menurut pendapatmu, berasal dari daerah mana makanan tersebut?
                    </label>
                    <textarea id="tanya2" rows="2"
                        class="w-full text-xs p-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-emerald-500 bg-slate-50 focus:bg-white transition-all placeholder:text-slate-300"
                        placeholder="Jawab..."></textarea>
                </div>

                <!-- Soal 3 -->
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-700 block leading-relaxed">
                        3. Apa bahan utama pembuat makanan tersebut? Apakah bahannya mudah didapatkan, dan berapa
                        harganya sekarang?
                    </label>
                    <textarea id="tanya3" rows="3"
                        class="w-full text-xs p-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-emerald-500 bg-slate-50 focus:bg-white transition-all placeholder:text-slate-300"
                        placeholder="Jawab..."></textarea>
                </div>

                <!-- Soal 4 -->
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-700 block leading-relaxed">
                        4. Apa kandungan gizi dari makanan tersebut? Menurutmu, bahan mana yang memberikan manfaat bagi
                        tubuh dan bahan mana yang jika dikonsumsi berlebih justru berisiko bagi kesehatan? Mengapa?
                    </label>
                    <textarea id="tanya4" rows="4"
                        class="w-full text-xs p-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-emerald-500 bg-slate-50 focus:bg-white transition-all placeholder:text-slate-300"
                        placeholder="Jawab..."></textarea>
                </div>

                <!-- Soal 5 -->
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-700 block leading-relaxed">
                        5. Jika jajanan tersebut akan kamu jual di bazar dengan label 'Kuliner Sehat & Bergizi', inovasi
                        apa yang harus kamu lakukan pada bahan atau cara pengolahannya agar orang tertarik membeli namun
                        tetap mendapatkan manfaat kesehatan?
                    </label>
                    <textarea id="tanya5" rows="4"
                        class="w-full text-xs p-3 rounded-xl border border-slate-200 focus:border-emerald-500 focus:ring-emerald-500 bg-slate-50 focus:bg-white transition-all placeholder:text-slate-300"
                        placeholder="Jawab..."></textarea>
                </div>

            </div>

            <!-- Footer -->
            <div class="p-5 border-t border-slate-100 bg-slate-50/50">
                <button id="btnSubmitPemantik" onclick="submitPemantik()"
                    class="w-full py-3.5 rounded-xl bg-emerald-custom text-white font-bold text-sm shadow-lg shadow-emerald-500/20 active:scale-[0.98] transition-all hover:bg-emerald-600">
                    Kirim Jawaban
                </button>
            </div>
        </div>
    </div>
    <!-- MODAL MATERI BELAJAR (SLIDE) -->
    <div id="modalMateri"
        class="fixed inset-0 z-[200] hidden items-center justify-center bg-slate-900/60 backdrop-blur-md p-0 md:p-4 animate-fade-in">
        <div
            class="bg-white w-full max-w-lg h-full md:h-auto md:max-h-[85vh] md:rounded-[2.5rem] shadow-2xl flex flex-col overflow-hidden relative">

            <!-- Progress Top -->
            <div class="absolute top-0 left-0 w-full h-1.5 bg-slate-100">
                <div id="materiProgressBar" class="h-full bg-emerald-500 transition-all duration-500"
                    style="width: 12.5%"></div>
            </div>

            <!-- Header -->
            <div class="px-6 pt-8 pb-4 flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="size-10 rounded-xl bg-emerald-50 text-emerald-600 flex items-center justify-center">
                        <span class="material-symbols-outlined font-icon">menu_book</span>
                    </div>
                    <div>
                        <h3 class="text-sm font-black text-slate-800 leading-tight">Materi Hari 1</h3>
                        <p id="materiStepText" class="text-[10px] text-slate-500 font-bold uppercase tracking-widest">
                            Halaman 1 dari 8</p>
                    </div>
                </div>
                <button onclick="closeMateriModal()"
                    class="size-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 hover:bg-slate-100 transition-all">
                    <span class="material-symbols-outlined text-xl">close</span>
                </button>
            </div>

            <!-- Content Area -->
            <div id="materiContentArea" class="flex-1 overflow-y-auto px-6 py-4 no-scrollbar">

                <!-- SLIDE 1: PENGERTIAN -->
                <div id="slide-materi-0" class="animate-slide-up">
                    <div class="flex flex-col items-center text-center mb-6">
                        <span class="material-symbols-outlined text-5xl text-emerald-500 mb-2">info</span>
                        <h4 class="text-lg font-black text-slate-800">Bab I: Pengertian & Ruang Lingkup</h4>
                    </div>
                    <div class="space-y-4 text-sm text-slate-600 leading-relaxed font-medium">
                        <p>Jajanan Nusantara adalah istilah yang mencakup berbagai jenis penganan atau makanan selingan
                            tradisional asli Indonesia. Jajanan ini lahir dari kreativitas masyarakat dalam mengolah
                            kekayaan sumber daya alam lokal yang melimpah, seperti beras, ketan, singkong, ubi, jagung,
                            kelapa, hingga gula aren.</p>
                        <p>Secara umum, jajanan Nusantara memiliki karakteristik yang membedakannya dari camilan modern,
                            antara lain:</p>
                        <div class="bg-emerald-50 p-4 rounded-2xl border border-emerald-100">
                            <ul class="space-y-3 text-xs text-slate-700">
                                <li class="flex gap-2"><span class="text-emerald-500 font-bold">•</span> <strong>Bentuk
                                        dan Porsi:</strong> Biasanya berukuran kecil dan praktis untuk dimakan sekali
                                    habis (bite-sized portions).</li>
                                <li class="flex gap-2"><span class="text-emerald-500 font-bold">•</span> <strong>Nilai
                                        Ekonomis:</strong> Harganya relatif terjangkau oleh semua lapisan masyarakat
                                    karena bahan bakunya mudah didapat.</li>
                                <li class="flex gap-2"><span class="text-emerald-500 font-bold">•</span>
                                    <strong>Kekhasan Bahan Alami:</strong> Banyak menggunakan bahan alami tanpa pengawet
                                    atau pemanis buatan, dengan pewarna dari tumbuhan (pandan, suji, atau kunyit) dan
                                    bungkus daun pisang yang memberikan aroma khas.
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- SLIDE 2: SEJARAH -->
                <div id="slide-materi-1" class="hidden animate-slide-up">
                    <div class="flex flex-col items-center text-center mb-6">
                        <span class="material-symbols-outlined text-5xl text-amber-500 mb-2">history</span>
                        <h4 class="text-lg font-black text-slate-800">Bab II: Sejarah & Perkembangan</h4>
                    </div>
                    <div class="space-y-4 text-sm text-slate-600 leading-relaxed font-medium">
                        <p>Sejarah jajanan Nusantara dimulai dari tradisi kuliner lokal yang sudah ada sejak sebelum era
                            kerajaan. Masyarakat awalnya mengolah bahan dasar melalui teknik sederhana seperti direbus
                            atau dikukus. Seiring berjalannya waktu, kekayaan rasa ini berkembang pesat melalui
                            interaksi budaya:</p>
                        <div class="space-y-4">
                            <div class="relative pl-6 border-l-2 border-slate-100">
                                <div
                                    class="absolute -left-[9px] top-0 size-4 rounded-full bg-emerald-500 border-4 border-white">
                                </div>
                                <p class="text-xs font-black text-emerald-600 uppercase mb-1">Pengaruh Tionghoa (Abad
                                    ke-7)</p>
                                <p class="text-[13px]">Membawa teknik pengolahan berbagai jenis tepung dan metode
                                    menggoreng. Banyak istilah "kue" berasal dari serapan bahasa Hokkien.</p>
                            </div>
                            <div class="relative pl-6 border-l-2 border-slate-100">
                                <div
                                    class="absolute -left-[9px] top-0 size-4 rounded-full bg-blue-500 border-4 border-white">
                                </div>
                                <p class="text-xs font-black text-blue-600 uppercase mb-1">Pengaruh Eropa/Kolonial</p>
                                <p class="text-[13px]">Memperkenalkan teknik memanggang (oven) serta penggunaan bahan
                                    seperti mentega, susu, dan telur yang kemudian diadaptasi menjadi kue-kue premium
                                    tradisional.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SLIDE 3: TEKNIK -->
                <div id="slide-materi-2" class="hidden animate-slide-up">
                    <div class="flex flex-col items-center text-center mb-6">
                        <span class="material-symbols-outlined text-5xl text-orange-500 mb-2">cooking</span>
                        <h4 class="text-lg font-black text-slate-800">Bab III: Teknik Pengolahan</h4>
                    </div>
                    <div class="space-y-4 text-sm text-slate-600 leading-relaxed font-medium">
                        <p>Setiap daerah di Indonesia memiliki keahlian unik dalam mengolah jajanan. Teknik pengolahan
                            sangat menentukan tekstur dan cita rasa akhir:</p>
                        <div class="grid grid-cols-1 gap-3">
                            <div class="p-4 bg-slate-50 rounded-2xl border border-slate-100 flex gap-4">
                                <span class="material-symbols-outlined text-emerald-500 flex-shrink-0">cloud</span>
                                <div>
                                    <p class="text-xs font-black text-slate-800 uppercase mb-1">Teknik Mengukus &
                                        Merebus</p>
                                    <p class="text-[12px]">Teknik tertua yang menjaga kelembapan bahan. Contoh:
                                        Nagasari, Putu Ayu, dan Klepon yang direbus hingga mengapung.</p>
                                </div>
                            </div>
                            <div class="p-4 bg-slate-50 rounded-2xl border border-slate-100 flex gap-4">
                                <span
                                    class="material-symbols-outlined text-orange-500 flex-shrink-0">local_fire_department</span>
                                <div>
                                    <p class="text-xs font-black text-slate-800 uppercase mb-1">Teknik Membakar &
                                        Menyangrai</p>
                                    <p class="text-[12px]">Memberikan aroma asap (smoky) yang khas, biasanya
                                        diaplikasikan pada jajanan berbahan dasar ketan atau kelapa parut.</p>
                                </div>
                            </div>
                            <div class="p-4 bg-slate-50 rounded-2xl border border-slate-100 flex gap-4">
                                <span class="material-symbols-outlined text-blue-500 flex-shrink-0">frying_pan</span>
                                <div>
                                    <p class="text-xs font-black text-slate-800 uppercase mb-1">Teknik Modern (Baking &
                                        Frying)</p>
                                    <p class="text-[12px]">Adaptasi teknologi yang menghasilkan tekstur renyah di luar
                                        namun lembut di dalam. Contoh: Bika Ambon dan berbagai gorengan sehat.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SLIDE 4: ATLAS -->
                <div id="slide-materi-3" class="hidden animate-slide-up">
                    <div class="flex flex-col items-center text-center mb-6">
                        <span class="material-symbols-outlined text-5xl text-indigo-500 mb-2">map</span>
                        <h4 class="text-lg font-black text-slate-800">Bab IV: Atlas Kuliner Nusantara</h4>
                    </div>
                    <div class="space-y-4 text-xs font-medium text-slate-600">
                        <p class="text-center italic mb-2">Identitas rasa setiap wilayah:</p>
                        <div class="space-y-3">
                            <div class="p-3 bg-indigo-50 rounded-2xl">
                                <p class="font-black text-indigo-900 mb-1">Pulau Sumatra</p>
                                <p>Terkenal dengan rasa yang kuat dan penggunaan santan serta rempah. Contoh: Timphan
                                    (Aceh), Lapis Legit (Lampung), Bika Ambon (Medan).</p>
                            </div>
                            <div class="p-3 bg-emerald-50 rounded-2xl">
                                <p class="font-black text-emerald-900 mb-1">Pulau Jawa</p>
                                <p>Dominasi rasa manis dari gula merah dan kelapa. Contoh: Surabi (Jabar), Getuk
                                    (Jateng), Klepon (Jatim), Bakpia (DIY).</p>
                            </div>
                            <div class="p-3 bg-amber-50 rounded-2xl">
                                <p class="font-black text-amber-900 mb-1">Sulawesi, Bali, hingga Papua</p>
                                <p>Menonjolkan hasil bumi lokal seperti jagung, sagu, dan pisang. Contoh: Barongko
                                    (Sulsel), Kue Sagu Lempeng (Papua), Laklak (Bali).</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SLIDE 5: GIZI -->
                <div id="slide-materi-4" class="hidden animate-slide-up">
                    <div class="flex flex-col items-center text-center mb-6">
                        <span class="material-symbols-outlined text-5xl text-rose-500 mb-2">nutrition</span>
                        <h4 class="text-lg font-black text-slate-800">Bab V: Analisis Kandungan Gizi</h4>
                    </div>
                    <div class="space-y-4 px-2">
                        <div class="overflow-x-auto rounded-xl border border-slate-200">
                            <table class="w-full text-left text-[9px]">
                                <thead class="bg-slate-50 border-b border-slate-200 text-slate-700">
                                    <tr>
                                        <th class="p-2 font-black">Asal Wilayah/Provinsi</th>
                                        <th class="p-2 font-black">Bahan Utama</th>
                                        <th class="p-2 font-black">Kandungan Utama Zat Gizi</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-100 font-medium text-slate-600">
                                    <tr>
                                        <td class="p-2">Sumatra Utara (Medan)</td>
                                        <td class="p-2">Kuning telur, santan, tapioka</td>
                                        <td class="p-2">Energi, lemak, karbohidrat sederhana</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Sumatra Selatan (Palembang)</td>
                                        <td class="p-2">Kuning telur, santan, gula</td>
                                        <td class="p-2">Protein (telur), karbohidrat</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Lampung</td>
                                        <td class="p-2">Kuning telur, mentega, gula</td>
                                        <td class="p-2">Lemak jenuh, energi tinggi</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Jawa Barat</td>
                                        <td class="p-2">Tepung beras, santan, kelapa</td>
                                        <td class="p-2">Karbohidrat, serat (kelapa)</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Jawa Tengah</td>
                                        <td class="p-2">Singkong, gula jawa</td>
                                        <td class="p-2">Serat pangan, karbohidrat kompleks</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Yogyakarta</td>
                                        <td class="p-2">Tepung terigu, kacang hijau</td>
                                        <td class="p-2">Protein nabati, serat</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Jawa Timur</td>
                                        <td class="p-2">Tepung beras, kelapa, gula aren</td>
                                        <td class="p-2">Energi, elektrolit (gula kelapa)</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Bali</td>
                                        <td class="p-2">Tepung beras, santan</td>
                                        <td class="p-2">Karbohidrat</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Sulawesi Selatan</td>
                                        <td class="p-2">Pisang, santan, telur</td>
                                        <td class="p-2">Kalium (pisang), protein</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Nusa Tenggara Barat</td>
                                        <td class="p-2">Ubi jalar/singkong, kelapa</td>
                                        <td class="p-2">Serat, karbohidrat kompleks</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2">Papua</td>
                                        <td class="p-2">Pati sagu alami</td>
                                        <td class="p-2">Karbohidrat kompleks, rendah gluten</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="text-[10px] text-slate-500 italic bg-amber-50 p-3 rounded-xl border border-amber-100">
                            Jajanan Nusantara berbasis umbi-umbian (singkong, ubi, sagu) cenderung lebih kaya serat
                            dibandingkan berbasis tepung terigu.</p>
                    </div>
                </div>

                <!-- SLIDE 6: INOVASI -->
                <div id="slide-materi-5" class="hidden animate-slide-up">
                    <div class="flex flex-col items-center text-center mb-6">
                        <span class="material-symbols-outlined text-5xl text-cyan-500 mb-2">lightbulb</span>
                        <h4 class="text-lg font-black text-slate-800">Bab VI: Strategi Inovasi</h4>
                    </div>
                    <div class="space-y-4 text-sm text-slate-600 leading-relaxed font-medium">
                        <p>Agar jajanan tradisional lebih sehat dan bergizi namun tetap diminati di bazar, diperlukan
                            inovasi di dua sisi:</p>
                        <div class="space-y-3">
                            <div class="p-4 bg-white border-2 border-dashed border-slate-100 rounded-2xl shadow-sm">
                                <p class="text-xs font-black text-cyan-700 uppercase mb-2 flex items-center gap-2"><span
                                        class="material-symbols-outlined text-sm">add_moderator</span> Fortifikasi
                                    Nutrisi</p>
                                <p class="text-[11px]">Menambahkan sayuran (seperti wortel atau bayam goreng halus) ke
                                    isi panada, atau menggunakan puree pisang asli yang lebih banyak untuk Barongko
                                    sebagai pengganti pemanis buatan.</p>
                            </div>
                            <div class="p-4 bg-white border-2 border-dashed border-slate-100 rounded-2xl shadow-sm">
                                <p class="text-xs font-black text-emerald-700 uppercase mb-2 flex items-center gap-2">
                                    <span class="material-symbols-outlined text-sm">published_with_changes</span>
                                    Substitusi Bahan Lebih Sehat
                                </p>
                                <p class="text-[11px]">Mengganti gula pasir dengan gula aren murni yang rendah indeks
                                    glikemik, atau menggunakan metode "Air Fryer" untuk jajanan yang biasanya digoreng
                                    terendam minyak (deep-fry).</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SLIDE 7: BAZAR -->
                <div id="slide-materi-6" class="hidden animate-slide-up">
                    <div class="flex flex-col items-center text-center mb-6">
                        <span class="material-symbols-outlined text-5xl text-purple-500 mb-2">storefront</span>
                        <h4 class="text-lg font-black text-slate-800">Bab VII: Manajemen Bazar</h4>
                    </div>
                    <div class="space-y-4 text-sm text-slate-600 leading-relaxed font-medium">
                        <p>Penjualan di bazar memerlukan perencanaan matang agar produk 'Kuliner Sehat' dilirik
                            pengunjung:</p>
                        <ul class="space-y-2 text-xs">
                            <li class="p-3 bg-slate-50 rounded-xl flex gap-3"><span
                                    class="font-bold text-purple-600">01.</span> <strong>Unique Selling Point
                                    (USP):</strong> Berikan label jelas bahwa jajanan ini adalah versi sehat (misal:
                                "Klepon Gula Aren Murni - Tanpa Pengawet").</li>
                            <li class="p-3 bg-slate-50 rounded-xl flex gap-3"><span
                                    class="font-bold text-purple-600">02.</span> <strong>Visual Display:</strong> Tata
                                stand dengan tema tradisional namun modern (estetika tinggi) untuk menarik perhatian
                                generasi muda.</li>
                            <li class="p-3 bg-slate-50 rounded-xl flex gap-3"><span
                                    class="font-bold text-purple-600">03.</span> <strong>Interaksi & Tester:</strong>
                                Sediakan contoh kecil (tester) dan jelaskan manfaat kesehatan dari inovasi yang telah
                                dilakukan.</li>
                        </ul>
                    </div>
                </div>

                <!-- SLIDE 8: KEMASAN -->
                <div id="slide-materi-7" class="hidden animate-slide-up">
                    <div class="flex flex-col items-center text-center mb-6">
                        <span class="material-symbols-outlined text-5xl text-sky-500 mb-2">package_2</span>
                        <h4 class="text-lg font-black text-slate-800">Bab VIII: Pengemasan & Labeling</h4>
                    </div>
                    <div class="space-y-4 text-sm text-slate-600 leading-relaxed font-medium">
                        <p>Kemasan adalah wajah pertama produk Anda. Untuk produk kuliner sehat, kemasan harus memenuhi
                            tiga kriteria:</p>
                        <div class="bg-sky-50 p-5 rounded-3xl border border-sky-100 space-y-4">
                            <div class="flex gap-3">
                                <span class="text-lg">♻️</span>
                                <div>
                                    <p class="font-bold text-sky-900 text-xs">Keamanan & Keberlanjutan</p>
                                    <p class="text-[11px] text-sky-700">Gunakan wadah ramah lingkungan (bambu, daun,
                                        atau wadah bio-degradable) yang aman bagi makanan.</p>
                                </div>
                            </div>
                            <div class="flex gap-3">
                                <span class="text-lg">🏷️</span>
                                <div>
                                    <p class="font-bold text-sky-900 text-xs">Informasi Transparan</p>
                                    <p class="text-[11px] text-sky-700">Cantumkan informasi bahan utama dan manfaat
                                        nutrisi pada label untuk meyakinkan pembeli bahwa produk memang sehat.</p>
                                </div>
                            </div>
                            <div class="flex gap-3">
                                <span class="text-lg">🎨</span>
                                <div>
                                    <p class="font-bold text-sky-900 text-xs">Design Estetik</p>
                                    <p class="text-[11px] text-sky-700">Gunakan grafis yang menarik yang mencerminkan
                                        kualitas premium produk Anda.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Footer Controls -->
            <div class="p-6 border-t border-slate-50 bg-white flex gap-3">
                <button id="btnPrevMateri" onclick="prevMateriSlide()"
                    class="flex-1 py-3.5 rounded-2xl bg-slate-50 text-slate-400 font-bold text-xs transition-all invisible">Kembali</button>
                <button id="btnNextMateri" onclick="nextMateriSlide()"
                    class="flex-[3] py-3.5 rounded-2xl bg-emerald-500 text-white font-bold text-xs shadow-lg shadow-emerald-500/20 active:scale-95">Selanjutnya</button>
                <button id="btnFinishMateri" onclick="settleMateri()"
                    class="flex-[3] py-3.5 rounded-2xl bg-emerald-600 text-white font-bold text-xs shadow-lg shadow-emerald-500/30 transition-all active:scale-95 hidden">Selesaikan
                    Materi</button>
            </div>
        </div>
    </div>

</body>

</html>